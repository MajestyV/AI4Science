import numpy as np

def ConfigSimilarity_MSE(config_1, config_2):
    """
    计算两个分子结构之间的均方误差 (Mean Squared Error, MSE)
    :return: 均方误差
    """
    config_delta = config_1 - config_2  # 计算两个分子结构之间的差异
    config_delta_norm_sq = np.linalg.norm(config_delta, axis=1)**2  # 计算每个原子坐标差异的范数
    mse = np.mean(config_delta_norm_sq ** 2)  # 计算误差
    return mse

if __name__ == "__main__":
    config_1 = [[-3.1733113,   2.05402777,  2.98380613], [-2.10969053,  1.96860015,  2.06954486], [-0.82304295,  1.23913881,  2.12031382],
                [-0.71882587,  1.25294716,  0.59436094], [-0.15068357,  0.21127147, -0.13407869], [-0.1550771,   2.43400199, -0.12809366],
                [-1.0849137,   3.69335001,  0.30813738], [-2.26646776,  2.88765094,  0.79596722], [-2.26698075,  1.44752493,  0.54890796],
                [-3.47811858,  1.22123142,  3.30867543], [-0.03024661,  1.94115509,  2.52214025], [-0.97731687,  0.35001103,  2.6895014 ],
                [-0.1255914,  -0.65379927,  0.32737087], [ 0.93974847,  2.47537899, -0.04380523], [-0.40713624,  2.1346385,  -1.16542917],
                [-0.47457934,  4.3332637,   0.98271499], [-1.40084326,  4.35886774, -0.53078509], [-3.15857264,  3.50570005,  0.75726289],
                [-3.1783487,   0.90426111,  0.20343011]]

    config_2 = [[-2.94441816,  1.96270309,  3.21717925], [-2.26572173,  1.93459145,  1.8958322 ], [-0.84853229,  1.44295747,  2.08269349],
                [-0.73372227,  1.22502105,  0.49182385], [-0.12892151,  0.05515384, -0.05312158], [-0.08741574,  2.50087317, -0.13428678],
                [-1.0586413,   3.64930202,  0.39244488], [-2.3937006,   2.91939492,  0.70944696], [-2.31343985,  1.45603816,  0.45049734],
                [-3.9084232,   2.22302013,  3.13180978], [-0.0292794,   2.01532041,  2.65792546], [-1.16187044,  0.48276414,  2.45807406],
                [-0.2936572,  -0.83498714,  0.20080125], [ 0.86321212,  2.60186975,  0.39013614], [-0.09658931,  2.50705133, -1.22904585],
                [-0.82257048,  4.13374682,  1.37297894], [-1.15856225,  4.54971318, -0.26517812], [-3.38397063,  3.38175637,  0.62235138],
                [-2.98710944,  0.99582383, -0.26531767]]

    config_1, config_2 = np.array(config_1), np.array(config_2)  # 转换为numpy数组

    # 计算均方误差
    mse = ConfigSimilarity_MSE(config_1, config_2)
    # mse = ConfigSimilarity_MSE(config_1, config_1)


    print(f"均方误差: {mse}")